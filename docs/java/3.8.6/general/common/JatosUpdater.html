<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_402) on Tue Apr 16 22:52:16 CEST 2024 -->
<title>JatosUpdater</title>
<meta name="date" content="2024-04-16">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="JatosUpdater";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../general/common/CommonGuiceModule.html" title="class in general.common"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../general/common/MessagesStrings.html" title="class in general.common"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?general/common/JatosUpdater.html" target="_top">Frames</a></li>
<li><a href="JatosUpdater.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">general.common</div>
<h2 title="Class JatosUpdater" class="title">Class JatosUpdater</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>general.common.JatosUpdater</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>@Singleton
public class <span class="typeNameLabel">JatosUpdater</span>
extends java.lang.Object</pre>
<div class="block">This class handles JATOS updates

 Some hints:
 - JATOS releases are currently stored at GitHub
 - The data requested from GitHub are stored in ReleaseInfo
 - If there is an 'n' in the release's version an update is forbidden. This is safety feature in case an future
 update is not compatible with this update process.
 - The new release might need a new Java version. The release's Java version is determined by the asset's filename
 (see newJavaVersion).
 - The current state of the update process (UpdateState) is stored in 'state'.
 - The update process is finished in the loader script
 - In the GUI the update is handled in the home view

 Update process:
 1. Check GitHub for a new releases and put release data into ReleaseInfo
 2. Ask user (GUI home view)
 3. Download and unzip new release into system's tmp folder
 4. Ask user (GUI home view)
 5. Move new release into a separate folder within the current JATOS installation folder
 6. Exchange loader scripts and config folder
 7. Restart JATOS: finish process with an stop hook that runs the new loader script with an 'update' parameter
 8. The loader script moves everything in the new release folder into the JATOS installation folder (eventual
 overwriting existing files)
 9. The loader script starts JATOS again
 10. JATOS shows a success msg (or a failure msg)</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../general/common/JatosUpdater.html#cancelUpdate--">cancelUpdate</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.concurrent.CompletionStage&lt;?&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../general/common/JatosUpdater.html#downloadFromGitHubAndUnzip-boolean-">downloadFromGitHubAndUnzip</a></span>(boolean&nbsp;dry)</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.util.concurrent.CompletionStage&lt;com.fasterxml.jackson.databind.JsonNode&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../general/common/JatosUpdater.html#getReleaseInfo-java.lang.String-boolean-">getReleaseInfo</a></span>(java.lang.String&nbsp;version,
              boolean&nbsp;allowPreReleases)</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../general/common/JatosUpdater.html#setUpdateStateFailed--">setUpdateStateFailed</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../general/common/JatosUpdater.html#setUpdateStateSuccess--">setUpdateStateSuccess</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../general/common/JatosUpdater.html#updateAndRestart-boolean-">updateAndRestart</a></span>(boolean&nbsp;backupAll)</code>
<div class="block">Backups, updates files and restarts JATOS</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setUpdateStateSuccess--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setUpdateStateSuccess</h4>
<pre>public&nbsp;void&nbsp;setUpdateStateSuccess()</pre>
</li>
</ul>
<a name="setUpdateStateFailed--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setUpdateStateFailed</h4>
<pre>public&nbsp;void&nbsp;setUpdateStateFailed()</pre>
</li>
</ul>
<a name="getReleaseInfo-java.lang.String-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReleaseInfo</h4>
<pre>public&nbsp;java.util.concurrent.CompletionStage&lt;com.fasterxml.jackson.databind.JsonNode&gt;&nbsp;getReleaseInfo(java.lang.String&nbsp;version,
                                                                                                    boolean&nbsp;allowPreReleases)</pre>
</li>
</ul>
<a name="cancelUpdate--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cancelUpdate</h4>
<pre>public&nbsp;void&nbsp;cancelUpdate()</pre>
</li>
</ul>
<a name="downloadFromGitHubAndUnzip-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>downloadFromGitHubAndUnzip</h4>
<pre>public&nbsp;java.util.concurrent.CompletionStage&lt;?&gt;&nbsp;downloadFromGitHubAndUnzip(boolean&nbsp;dry)</pre>
</li>
</ul>
<a name="updateAndRestart-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>updateAndRestart</h4>
<pre>public&nbsp;void&nbsp;updateAndRestart(boolean&nbsp;backupAll)
                      throws java.io.IOException</pre>
<div class="block">Backups, updates files and restarts JATOS</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>backupAll</code> - If true, everything in the JATOS directory will be copied into a backup folder. If false, only
                  the conf directory and the loader scripts.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../general/common/CommonGuiceModule.html" title="class in general.common"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../general/common/MessagesStrings.html" title="class in general.common"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?general/common/JatosUpdater.html" target="_top">Frames</a></li>
<li><a href="JatosUpdater.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
